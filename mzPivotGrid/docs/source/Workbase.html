<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Mz-pivot-dataexport-excel-Workbase'>/**
</span>*   Class used to create an Excel workbook
*/
Ext.define('Mz.pivot.dataexport.excel.Workbase', {
    
    requires: [
        'Ext.XTemplate',
        'Mz.pivot.dataexport.excel.Style'
    ],
    
<span id='Mz-pivot-dataexport-excel-Workbase-method-constructor'>    constructor: function (config) {
</span>        var me = this;
        
        config = Ext.clone(config || {});
        
        Ext.apply(me, config, {
<span id='Mz-pivot-dataexport-excel-Workbase-cfg-title'>            /**
</span>             * @cfg title
             * @type String
             * The title of the workbook
             */
            title: &quot;Workbook&quot;,

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-cellFontName'>            /**
</span>             * @cfg cellFontName
             * @type String
             * The default font name used in the workbook. This is applied when {hasDefaultStyle} is true.
             */
            cellFontName: &quot;Arial&quot;,

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-cellFontSize'>            /**
</span>             * @cfg cellFontSize
             * @type String
             * The default font size used in the workbook. This is applied when {hasDefaultStyle} is true.
             */
            cellFontSize: &quot;10&quot;,

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-cellBorderColor'>            /**
</span>             * @cfg cellBorderColor
             * @type String
             * The colour of border to use for each Cell
             */
            cellBorderColor: &quot;#E4E4E4&quot;,

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-cellFillColor'>            /**
</span>             * @cfg cellFillColor
             * @type String
             * The fill colour of each summary Cell
             */
            cellFillColor: &quot;&quot;,

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-titleFontSize'>            /**
</span>             * @cfg titleFontSize
             * @type String
             * Font size used for the table title
             */
            titleFontSize: &quot;14&quot;,

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-titleFillColor'>            /**
</span>             * @cfg titleFillColor
             * @type String
             * Fill folor used for the table title
             */
            titleFillColor: &quot;&quot;,

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-dateFormat'>            /**
</span>            * @cfg dateFormat
            * @type String
            * Default format used for the date values
            */
            dateFormat:     'Short Date',

<span id='Mz-pivot-dataexport-excel-Workbase-cfg-numberFormat'>            /**
</span>            * @cfg numberFormat
            * @type String
            * Default format used for the number values
            */
            numberFormat:   'Standard',
            
<span id='Mz-pivot-dataexport-excel-Workbase-property-styles'>            /**
</span>             * @property styles
             * @type Array
             * The array of Mz.pivot.dataexport.excel.Style objects attached to this object
             */
            styles: [],

<span id='Mz-pivot-dataexport-excel-Workbase-property-compiledStyles'>            /**
</span>             * @property compiledStyles
             * @type Array
             * Array of all rendered Mz.pivot.dataexport.excel.Style objects for this object
             */
            compiledStyles: []            
        });
    },
    
<span id='Mz-pivot-dataexport-excel-Workbase-method-addStyle'>    /**
</span>     * Adds a new Mz.pivot.dataexport.excel.Style to this Workbook
     * @param {Object} config The style config, passed to the Style constructor (required)
     */
    addStyle: function (config) {
        var me = this,
            style = Ext.create('Mz.pivot.dataexport.excel.Style', config || {});

        me.styles.push(style);

        return style;
    },

<span id='Mz-pivot-dataexport-excel-Workbase-method-getInteriorStyle'>    /**
</span>    * @private
    * 
    * @param fillColor
    */
    getInteriorStyle: function(fillColor){
        var style = {
            name: &quot;Interior&quot;
        };
        
        if(!Ext.isEmpty(fillColor)){
            style.properties = [
                { name: &quot;Pattern&quot;, value: &quot;Solid&quot; },
                { name: &quot;Color&quot;, value: fillColor }
            ];
        }
        
        return style;
    }

    
});</pre>
</body>
</html>
